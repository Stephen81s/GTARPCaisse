<script>
/****************************************************
 * script_ressource.html
 * --------------------------------------------------
 * Gestion des ressources :
 *  - SÃ©lection dâ€™une ressource
 *  - QuantitÃ©
 *  - Envoi au backend
 *  - Affichage du rÃ©sultat
 ****************************************************/

/****************************************************
 * ğŸš€ envoyerRessourceUI()
 ****************************************************/
function envoyerRessourceUI() {
  const ressource = document.getElementById("ressource-nom").value.trim();
  const qte = Number(document.getElementById("ressource-qte").value) || 0;

  if (!ressource) {
    alert("âš ï¸ Veuillez choisir une ressource.");
    return;
  }

  if (qte <= 0) {
    alert("âš ï¸ La quantitÃ© doit Ãªtre supÃ©rieure Ã  0.");
    return;
  }

  console.log("ğŸŸ¨ [RESSOURCE] Envoi :", { ressource, qte });

  google.script.run
    .withSuccessHandler(reponseRessource)
    .withFailureHandler(err => {
      console.error("ğŸ’¥ [RESSOURCE] ERREUR :", err);
      alert("âŒ Erreur lors de lâ€™envoi de la ressource.");
    })
    .enregistrerRessource({ ressource, qte });
}

/****************************************************
 * ğŸŸ© reponseRessource(retour)
 ****************************************************/
function reponseRessource(retour) {
  console.log("ğŸŸ© [RESSOURCE] RÃ©ponse backend :", retour);

  if (!retour || !retour.success) {
    alert("âŒ Impossible dâ€™enregistrer la ressource.");
    return;
  }

  alert("ğŸŸ© Ressource enregistrÃ©e avec succÃ¨s !");
  resetRessourceUI();
}

/****************************************************
 * ğŸ”„ resetRessourceUI()
 ****************************************************/
function resetRessourceUI() {
  document.getElementById("ressource-nom").value = "";
  document.getElementById("ressource-qte").value = 1;
}
</script>
