<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>RP Business System ‚Äî PRO 2026</title>

  <!-- Styles -->
  <link rel="stylesheet" href="styles/style_admin.css">
  <link rel="stylesheet" href="styles/style_global.css">
</head>

<body class="theme-light">

  <!-- ============================================================
       MENU LAT√âRAL
  ============================================================ -->
  <aside id="sidebar">
    <div class="menu-section">
      <h2>üìå Navigation</h2>
      <ul id="menu-links"></ul>
    </div>

    <div class="menu-section">
      <h2>‚öôÔ∏è Param√®tres</h2>
      <label for="themeSelect">Th√®me :</label>
      <select id="themeSelect" onchange="changeTheme()">
        <option value="light">Clair</option>
        <option value="dark">Sombre</option>
      </select>
    </div>
  </aside>

  <!-- ============================================================
       CONTENU PRINCIPAL (SPA)
  ============================================================ -->
  <main class="main-container">
    <div id="page-frame" class="page-frame">Chargement‚Ä¶</div>
  </main>

  <!-- ============================================================
       SCRIPTS
       IMPORTANT : config.js doit √™tre charg√© AVANT tout le reste
  ============================================================ -->
  <script src="scripts/spa.js"></script>
  <script src="scripts/config.js"></script>
  <script src="scripts/navigation.js"></script>
  

  <!-- Modules front -->
  <script src="scripts/admin_panel.js"></script>
  <script src="scripts/accueil.js"></script>
  <script src="scripts/joueurs.js"></script>
  <script src="scripts/entreprises.js"></script>
  <script src="scripts/employes.js"></script>
  <script src="scripts/maintenance.js"></script>

  <script>
    console.log("üü¶ [index] Initialisation‚Ä¶");

    /* ============================================================
       TH√àME
    ============================================================ */
    function loadTheme() {
      const theme = localStorage.getItem("theme") || "light";
      document.body.className = "theme-" + theme;
      document.getElementById("themeSelect").value = theme;
    }

    function changeTheme() {
      const theme = document.getElementById("themeSelect").value;
      localStorage.setItem("theme", theme);
      loadTheme();
    }

    /* ============================================================
       CHARGEMENT INITIAL
    ============================================================ */
    window.onload = async function () {
      loadTheme();

      // R√¥le utilisateur via API Web App
      const role = await api("ui_getUserRole");
      console.log("üü¶ [index] R√¥le utilisateur :", role);

      buildMenu(role);

      // Charge la page d'accueil via le SPA
      spa.loadPage("accueil");
    };
  </script>

</body>
</html>