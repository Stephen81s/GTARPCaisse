<script>
/****************************************************
 * script_ticket.html
 * --------------------------------------------------
 * Gestion du ticket :
 *  - Lecture du code
 *  - Envoi au backend
 *  - Affichage du rÃ©sultat
 ****************************************************/

/****************************************************
 * ğŸš€ validerTicketUI()
 ****************************************************/
function validerTicketUI() {
  const code = document.getElementById("ticket-id").value.trim();

  if (!code) {
    alert("âš ï¸ Veuillez entrer un numÃ©ro de ticket.");
    return;
  }

  console.log("ğŸŸï¸ [TICKET] Validation du ticket :", code);

  google.script.run
    .withSuccessHandler(reponseTicket)
    .withFailureHandler(err => {
      console.error("ğŸ’¥ [TICKET] ERREUR :", err);
      alert("âŒ Erreur lors de la validation du ticket.");
    })
    .validerTicket(code);
}

/****************************************************
 * ğŸŸ© reponseTicket(retour)
 ****************************************************/
function reponseTicket(retour) {
  console.log("ğŸŸ© [TICKET] RÃ©ponse backend :", retour);

  if (!retour || !retour.success) {
    alert("âŒ Ticket invalide ou dÃ©jÃ  utilisÃ©.");
    return;
  }

  alert("ğŸ‰ Ticket validÃ© avec succÃ¨s !");
  document.getElementById("ticket-id").value = "";
}
</script>
